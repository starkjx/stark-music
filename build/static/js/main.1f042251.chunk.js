(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,function(e,t,a){e.exports=a(21)},,,,,,function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),s=a(8),c=a.n(s),o=(a(15),a(2)),l=a(3),r=a(5),u=a(4),m=a(6),h=(a(16),a(17),a(18),a(1)),d=a.n(h),p=(a(19),function(e){function t(){return Object(o.a)(this,t),Object(r.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=d()("footer").find("li").outerWidth(!0);d()("ul").css({width:40*e+"px"})}},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{style:{backgroundImage:"url("+this.props.channel.cover_small+")"}}),i.a.createElement("h3",null,this.props.channel.name))}}]),t}(n.Component)),f=(a(20),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(r.a)(this,Object(u.a)(t).call(this,e))).state={},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"toggleCollect",value:function(){var e=d()(".btn-collect");e.hasClass("active")?e.removeClass("active"):e.addClass("active")}},{key:"render",value:function(){return i.a.createElement("main",{className:"layout"},i.a.createElement("div",{className:"music-panel"},i.a.createElement("figure",null),i.a.createElement("div",{className:"actions clearfix"},i.a.createElement("span",{className:"btn-collect iconfont icon-like",onClick:this.toggleCollect.bind(this)}),i.a.createElement("span",{className:"btn-play iconfont icon-play",onClick:this.props.onclickPlay}),i.a.createElement("span",{className:"btn-next iconfont icon-next",onClick:this.props.onNext}))),i.a.createElement("div",{className:"detail"},i.a.createElement("span",{className:"tag"},this.props.chName||"stark"),i.a.createElement("h1",null,this.props.song.title||"SONG NAME"),i.a.createElement("ul",{className:"icons clearfix"},i.a.createElement("li",null,i.a.createElement("span",{className:"iconfont icon-music"},"1234")),i.a.createElement("li",null,i.a.createElement("span",{className:"iconfont icon-like"},"123")),i.a.createElement("li",null,i.a.createElement("span",{className:"iconfont icon-appreciate"},"12"))),i.a.createElement("div",{className:"time-area"},i.a.createElement("div",{className:"bar",onClick:this.props.onChangeTime},i.a.createElement("div",{className:"bar-progress"})),i.a.createElement("div",{className:"current-time"},"0:00")),i.a.createElement("div",{className:"author"},this.props.song.artist||"author"),i.a.createElement("div",{className:"lyric"},i.a.createElement("p",null,"lyric"))))}}]),t}(n.Component)),v=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(r.a)(this,Object(u.a)(t).call(this,e))).state={channels:[],channelId:"",channelName:"stark",isToButtom:!1,isToStart:!0,isLoadAnimate:!1,song:[],lyric:{}},a.audio=new Audio,a.audio.autoplay=!0,a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;d.a.getJSON("https://jirenguapi.applinzi.com/fm/getChannels.php").done(function(t){var a=JSON.parse(JSON.stringify(e.state));a.channels=t.channels,e.setState(a)}).fail(function(){console.log("error")})}},{key:"clickLeft",value:function(){var e=this;if(!this.state.isLoadAnimate){var t=d()("footer").find("li").outerWidth(!0),a=Math.floor(d()("footer").find(".layout").width()/t);this.state.isToStart||(this.setState({isLoadAnimate:!0}),d()("footer ul").animate({left:"+="+a*t},400,function(){e.setState({isToButtom:!1,isLoadAnimate:!1}),parseInt(d()("footer ul").css("left"))>=0&&e.setState({isToStart:!0})}))}}},{key:"clickRight",value:function(){var e=this;if(!this.state.isLoadAnimate){var t=d()("footer").find("li").outerWidth(!0),a=Math.floor(d()("footer").find(".layout").width()/t);this.state.isToButtom||(this.setState({isLoadAnimate:!0}),d()("footer ul").animate({left:"-="+a*t},400,function(){e.setState({isToStart:!1,isLoadAnimate:!1}),parseInt(d()("footer .layout").width())-parseInt(d()("footer ul").css("left"))>parseInt(d()("footer ul").css("width"))&&e.setState({isToButtom:!0})}))}}},{key:"clickActive",value:function(e){var t=e.currentTarget,a=[].indexOf.call(t.parentElement.children,t),n=this.state.channels[a].channel_id,i=this.state.channels[a].name;d()(t).addClass("active").siblings().removeClass("active");var s=JSON.parse(JSON.stringify(this.state));s.channelId=n,s.channelName=i,this.setState(s),this.playSong()}},{key:"playSong",value:function(){var e=this;d.a.getJSON("https://jirenguapi.applinzi.com/fm/getSong.php",{channel:e.state.channelId}).done(function(t){var a=JSON.parse(JSON.stringify(e.state));a.song=t.song[0],e.setState(a),e.audio.src=t.song[0].url,d()(".music-panel figure").css("background-image","url("+t.song[0].picture+")"),d()(".background").css("background-image","url("+t.song[0].picture+")"),e.loadLyric(t.song[0].sid)})}},{key:"clickPlay",value:function(){var e=d()(".btn-play");e.hasClass("icon-stop")?(e.removeClass("icon-stop").addClass("icon-play"),this.audio.pause()):(e.removeClass("icon-play").addClass("icon-stop"),this.audio.play())}},{key:"playNext",value:function(){this.playSong()}},{key:"updateStatue",value:function(){var e=Math.floor(this.audio.currentTime/60),t=Math.floor(this.audio.currentTime%60)+"";t=2===t.length?t:"0"+t,d()(".detail .current-time").text(e+":"+t),d()(".detail .bar-progress").css("width",this.audio.currentTime/this.audio.duration*100+"%");var a=this.state.lyric["0"+e+":"+t];a&&d()(".detail .lyric p").text(a).boomText("rollIn")}},{key:"changeTime",value:function(e){var t=(e.clientX-e.currentTarget.getBoundingClientRect().x)/parseInt(getComputedStyle(e.currentTarget).width);this.audio.currentTime=t*this.audio.duration}},{key:"loadLyric",value:function(e){var t=this;d.a.getJSON("https://jirenguapi.applinzi.com/fm/getLyric.php",{sid:e}).done(function(e){var a={};e.lyric.split("\n").forEach(function(e){var t=e.match(/\d{2}:\d{2}/g);Array.isArray(t)&&t.forEach(function(t){a[t]=e.replace(/\[.+?\]/g,"")})}),t.setState({lyric:a})})}},{key:"render",value:function(){var e=this,t=this.state.channels.map(function(t,a){return i.a.createElement("li",{key:a,className:"cover",onClick:e.clickActive.bind(e)},i.a.createElement(p,{channel:t}))}),a=this;return this.audio.addEventListener("play",function(){clearInterval(a.statusClock),a.statusClock=setInterval(function(){a.updateStatue()},1e3)}),this.audio.addEventListener("pause",function(){clearInterval(a.statusClock)}),this.audio.addEventListener("ended",function(){a.playSong()}),i.a.createElement("div",{className:"App"},i.a.createElement("section",{id:"page-music"},i.a.createElement(f,{chId:this.state.channelId,chName:this.state.channelName,song:this.state.song,onclickPlay:this.clickPlay.bind(this),onNext:this.playNext.bind(this),onChangeTime:this.changeTime.bind(this)}),i.a.createElement("footer",null,i.a.createElement("div",{className:"layout"},i.a.createElement("span",{className:"iconfont icon-back",onClick:this.clickLeft.bind(this)}),i.a.createElement("span",{className:"iconfont icon-right",onClick:this.clickRight.bind(this)}),i.a.createElement("div",{className:"music-box"},i.a.createElement("ul",{className:"clearfix"},t))))),i.a.createElement("div",{className:"background"}))}}]),t}(n.Component);d.a.fn.boomText=function(e){e=e||"rollIn",this.html(function(){return d()(this).text().split("").map(function(e){return'<span class="boomText">'+e+"</span>"}).join("")});var t=0,a=d()(this).find("span"),n=setInterval(function(){a.eq(t).addClass("animated "+e),++t>=a.length&&clearInterval(n)},200)};var g=v;Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(g,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}],[[9,1,2]]]);
//# sourceMappingURL=main.1f042251.chunk.js.map